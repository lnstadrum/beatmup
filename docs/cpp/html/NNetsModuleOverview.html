<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Beatmup: NNets module overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Beatmup
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('NNetsModuleOverview.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespaceBeatmup_1_1NNets.html" title="Neural nets inference on GPU using OpenGL.">NNets</a> module overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Beatmup provides a way to run inference of user-defined neural networks on GPU using OpenGL.</p>
<p>The neural network (a <a class="el" href="classBeatmup_1_1NNets_1_1Model.html" title="Neural net model.">NNets::Model</a> instance) can be built in one of two ways:</p><ul>
<li>layer-by-layer in the user code, by adding instances of <a class="el" href="classBeatmup_1_1NNets_1_1AbstractOperation.html" title="Abstract neural net operation (layer).">NNets::AbstractOperation</a>,</li>
<li>loading a model using <a class="el" href="classBeatmup_1_1NNets_1_1DeserializedModel.html" title="Model reconstructed from a serialized representation.">NNets::DeserializedModel</a> from a Yaml-like text description (see <a class="el" href="NNetsModelSerialization.html">NNets model serialization format</a>).</li>
</ul>
<p>The model data (e.g., convolution filters values) is stored in a <a class="el" href="classBeatmup_1_1ChunkCollection.html" title="A key-value pair set storing pieces of arbitrary data (chunks) under string keys.">ChunkCollection</a> as plain single precision floating point arrays. They are indexed using the operation names. The model instance and input/output containers are supplied to <a class="el" href="classBeatmup_1_1NNets_1_1InferenceTask.html" title="Task running inference of a Model.">NNets::InferenceTask</a> which can be run in a thread pool of a <a class="el" href="classBeatmup_1_1Context.html" title="Basic class: task and memory management, any kind of static data.">Context</a>, just as another <a class="el" href="classBeatmup_1_1AbstractTask.html" title="Task: an operation that can be executed by multiple threads in parallel.">AbstractTask</a>.</p>
<p>Under the hood, the network is converted into a set of OpenGL ES 2.0-compliant GLSL shaders. The data is stored in textures in GPU memory. Beatmup takes care of building and executing shader programs.</p>
<p>With this Beatmup enables hardware-accelerated inference on any decent GPU, keeping the CPU available for other tasks. It allows to deploy easily the same model on various hardware, including inexpensive single-board computers, Android GPUs, integrated and discrete desktop GPUs from any vendor.</p>
<p>However, <a class="el" href="namespaceBeatmup_1_1NNets.html" title="Neural nets inference on GPU using OpenGL.">NNets</a> module is still quite young and comes with a set of limitations.</p><ul>
<li>The set of implemented features is limited. So far it is oriented to image classification and feature extraction exclusively. See <a class="el" href="classBeatmup_1_1NNets_1_1AbstractOperation.html" title="Abstract neural net operation (layer).">NNets::AbstractOperation</a> subclasses for the list of implemented neural network operations.</li>
<li>Not any model can be transformed into a Beatmup-compliant model. Most likely, a model needs to be designed and trained from scratch to be deployed with Beatmup. See <a class="el" href="classBeatmup_1_1NNets_1_1Conv2D.html" title="2D convolution operation computed on GPU.">NNets::Conv2D</a>, <a class="el" href="classBeatmup_1_1NNets_1_1Pooling2D.html" title="2D pooling operation computed on GPU.">NNets::Pooling2D</a> and <a class="el" href="classBeatmup_1_1NNets_1_1Dense.html" title="Dense (linear) layer.">NNets::Dense</a> operations descriptions for their corresponding constraints.</li>
<li>OpenGL may introduce a significant overhead. The inference thoughput achievable with Beatmup on powerful desktop GPUs is much likely limited compared to what can be achieved with vendor-specific proprietary technologies widely used for training and inference.</li>
<li>There are constraints related to the OpenGL ES 2.0 backend.<ul>
<li>The activations of almost all operations are stored as 8-bit integers. This may require the training to be somehow aware of the activations quantization, otherwise with the increasing depth the error due to the quantization may cause performance degradation. However, the weights of the network are usually not quantized:<ul>
<li>Conv2D filters and biases are stored in a floating point format. Possible quantization may apply if a given GPU does not support the single precision floating point computations.</li>
<li>Dense layers matrices and bias vectors are stored in floating point format if the GPU is OpenGL ES 3.1-compliant. Otherwise, a 16 bits fixed point representation is used.</li>
</ul>
</li>
<li>The 8-bit sampled activations cover [0, 1] range. This strongly limits the activation functions that can be used in the model.</li>
<li>OpenGL may be inefficient to sample many feature channels at the same time or have hardware or driver-defined hard limit on the number of samples per output value (the latter is the case for Raspberry Pi). This constraints the width of the network. To overcome this, group convolutions and <a class="el" href="classBeatmup_1_1NNets_1_1Model.html#NNetsShufflingExplained">channel shuffling</a> are suggested. The latter allows to shuffle channels between layers literally for free, which helps to increase the connectivity across the width of the network for group convolutions in particular.</li>
</ul>
</li>
<li>The batch size is fundamentally and unconditionally equal to 1, i.e., the inference is run for one given input image at a time. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Nov 21 2023 13:54:27 for Beatmup by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
